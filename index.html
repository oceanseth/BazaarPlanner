<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="BazaarPlanner is a tool that helps you create, simulate, and share bazaar builds.">
        <meta name="keywords" content="bazaar planner, bazaar, builds, sharing, create bazaar builds, bazaar simulator, test bazaar builds">
        <meta name="author" content="SimplyStrong">
  
        <!-- Open Graph / Facebook Meta Tags -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://www.bazaarplanner.com/">
        <meta property="og:title" content="BazaarPlanner - Create and Share Bazaar Builds">
        <meta property="og:description" content="BazaarPlanner is a tool that helps you create, simulate, and share bazaar builds.">
        <meta property="og:image" content="/images/logo.png">
    
        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:url" content="https://www.bazaarplanner.com/">
        <meta name="twitter:title" content="BazaarPlanner - Create, Simulate, and Share Bazaar Builds">
        <meta name="twitter:description" content="BazaarPlanner is a tool that helps you create and share bazaar builds effortlessly. Plan and organize your ideal marketplace.">
        <meta name="twitter:image" content="/images/logo.png">

        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth.js"></script>
        <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.1.0/firebase-ui-auth.css" />  
        <link rel="stylesheet" href="styles.css">
        <script type="module" src="/js/main.js"></script>
        <title>BazaarPlanner - Create, Simulate, and Share Bazaar Builds</title>
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
        <link rel="manifest" href="/site.webmanifest" />
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5415281723709994"
     crossorigin="anonymous"></script>
    </head>
    <body>
        <div id="Menu">
            <button onclick="showSection('simulator',event)">Simulator</button>
            <button class="section-header-selected" onclick="showSection('puzzle',event)">Daily Puzzle</button>
            <button onclick="showSection('about',event)">About</button>
            <button onclick="showSection('faq',event)">FAQ</button>
            
            <div id="poll-results" style="display: flex; align-items: center;"></div>
            <a href="javascript:showSection('settings',event)"  style="margin-left: auto; display: flex; align-items: center; text-decoration: none; font-size: 20px; line-height: 20px; border:1px solid black; background-color:rgba(0,0,0,0.7); color: white; padding: 5px; border-radius: 5px;">⚙️</a>
        </div>
        <div id="settings" class="section" style="display: none;">
            <h1>Mode</h1>
            <button onclick="toggleDarkMode()">Toggle Dark Mode</button>
            <h1>Account</h1>
            <div id="account-content">
                We will never share your account details with anyone else, excepting your display name and the image in your photo url.<br/>
                <div id="account-details" style='background-color: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px;'></div>
                Soon we will show stats on puzzle solves, and more.<br/>
                Set your display name to show on the site.<br/><br/>
                What shall we call you?
                <input type="text" id="update-account-display-name" placeholder="display name">
                <button onclick="Account.updateDisplayName()">Save</button>
                <br/><br/>
                <!--
                What icon should represent you?
                <input type="text" id="update-account-icon" placeholder="icon url">
                <button onclick="Account.updateIcon()">Save</button>
                -->
                <br/><br/>
                <button onclick="logout()" style="margin-left: auto;">Logout</button>
            </div>
        </div>
        <div id="puzzle" class="section">
            <div id="puzzle-content">
                <h1 id="puzzle-title">Daily Puzzle</h1>
                <p id="puzzle-description" align="center"></p>
                <div class="puzzle-slider-container">
                    <input type="range" id="puzzle-guess-slider" min="0" max="100" value="0" step="1" oninput="this.nextElementSibling.nextElementSibling.textContent = this.value">
                    <div class="slider-labels">
                        <span>0</span>
                        <span>100</span>
                    </div>
                    <div style="text-align: center; margin-top: 5px;"><b id="slider-value">0</b></div>
                    <br/><br/>
                    <div style="text-align: center; margin-top: 5px;">
                        <button class="editorOpener" onclick="Puzzle.submitGuess()">Submit</button>
                    </div>
                </div>
            </div>   
            
            <div class="board-container">
                <div id="puzzle-top" class="board"></div>
            </div>
            <div class="board-container">
                <div id="puzzle-bottom" class="board"></div>
            </div>
            <textarea id="puzzle-combatlog" class="combat-log"></textarea>
        </div>
        <!-- FAQ Section -->
        <div id="faq" class="section" style="display: none;">
            <h1>FAQ</h1><ul class="faq-list">
                <li>
                <b>How do I use BazaarPlanner?</b><br>
                I used to enjoy importing a run from <a href="https://bazaartracker.gg/">BazaarTracker</a>, (before it was taken down)which will bring all items/skills from the most recent battle in your current run.
                <br>You can use the simulator to test out different positioning of items and see how they perform.
                <br>
                One great use would be someone sharing their build on youtube, and you want to try it out for yourself or tweak positioning of items, and learn why it works best one way over another.
                After moving items around, run a battle and see if the dps is higher or lower than the original build.<br>
                Remember, you can always add 'sparring partner' to the top board to test against a monster that will never die! How long can you survive the sandstorm?!
            </li>
            <li>
                <b>What is DPS/HPS/SPS?</b><br>

                DPS is damage per second, HPS is healing per second, and SPS is shield per second.<br>
                You can pause battle at any time to see the current DPS/HPS/SPS for each board.
            </li>
            <li>
                <b>How do I save my build?</b><br>
                You can save your build by clicking the "Save" button on the bottom board, which saves a json file you can load later. 
            </li>
            <li>
                <b>Why is the url changing?</b><br>
                The url changes whenever you change the boards, skills, or player data. It allows you to share the current state of the boards with others. I recommend creating a url from <a href="http://tinyurl.com">tinyurl.com</a> to make a nice short url that you can share on youtube video descriptions, blogs, etc.
            </li>
            <li>
                <b>Where can I get support/report bugs/ask questions?</b><br>
                Strong's discord is the best place to get support. <a href="https://discord.gg/8CJwZVj823">https://discord.gg/8CJwZVj823</a>
            </li>
            <li><b>Why isn't it working on my mobile device?</b><br>
                I have no plans to support mobile devices. 
            </li>
            <li>
                <b>Can I run the battle 100 times to see the avg number of wins? Or avg dps across all battles?</b><br>
                No, the simulator is designed to simulate a single battle. We don't want to affect the game negatively by, for example, identifying the optimal positioning by running such tasks in the background. This is up to you to discover/learn!
            </li>
            <li><b>Can you speed up the battle please? Or just give me a button to see the result?</b><br/>
                No, the simulator is designed to simulate a single battle. We don't want to affect the game negatively by, for example, identifying the optimal positioning by running such tasks in the background. This is up to you to discover/learn!
            </li>
            </ul>


        </div>
        <!-- About Section -->



        <div id="about" class="section" style="display: none;">

            <h1>About</h1>
            <p>
                BazaarPlanner is a simulator for <A href="http://www.playthebazaar.com">The Bazaar</A>.
                It started as a way for "Strong" to teach "simply Noah" javascript (our discord names).
                Any donations will support his ongoing education, and the continued development of this tool. 
                If you've donated at least $1, (and logged in with google or the same email you used to donate) you will not be served google ads.
                <br/><br/>
                This project is currently in development. We update about a day after every patch, and most things are currently matching in-game exactly at that time.
            </p>
            <h1>Simulator Differences from the Actual Game Engine</h1>
            If you don't see something mentioned below, please let us know!
            <ul>
                <li>1. If items should trigger at the same time, 'priority' from bazaardb.gg is used to determine order. 
                    This has recently been added, and is not yet being enforced on some enchantment effects that had different priorities than their item's effects. 
                    For example, a toxic weights is really weird; The toxic effect has a priority of 'medium', while the weights effect has a priority of 'high'. 
                    We randomize the trigger order of items with the same priority and cooldown, but the game might use left to right order. I'm looking into this and will update as soon as I have more information.
                    So in game, if a 'medium' priority weapon was on the left of the weights, had poison and the same cooldown as the weights, the weights will first add damage to the weapon, the weapon will trigger, then the toxic weights will add poison, and that added poison will not have been added before the weapon already applied it's poison.
                    I personally think this is a really odd implementation as these 'priority' values are not consistent/obvious without inspecting the code (or looking it up online from someone who has and published it, which Reynad is serving DMCA takedowns for). 
                    In this simulator, the weights enchantment priority will always match the weights priority. 
                    Oddly, weights and pyg's gym have very different priorities even though they do similar things - the gym is low priority while the weights is high.  
                    </li>
                    <li>2. Some enchanted effects are not being parsed/triggering the same they do in game.
                         The game also has many bugs, for example an obsidian magma core works in the sim as expected, but in the game it's bugged and doens't do damage.</li>

            </ul>
            <h1>Coming Soon</h1>
            <p style="width:400px;">
                <ul>
                    <li>1. Create a desktop client you can run to give a button that will bring your current board in game into bazaarplanner (by generating a url with the board data).</li>
                    <li>2. Awaiting game API (or ressurection of bazaar tracker or some other approved tool using official api), but some way to show a leaderboard of the top 100 builds seen on each day, by simulating battles against all other builds on that day submitted in the past month.</li>
                    <li>3. Also if some tool like bazaar tracker is approved, being able to see your previous runs, and battles from those runs to select from to populate the boards. (We had this when bazaar tracker was up, and it was so nice).</li>
                    <li>4. Community items/skills - enable a creator tool for community items/skills which you can test out in the sim and thumbs up/down, and show a ranking of all the items.</li>
                </ul>
                <b>Send other ideas and things you might want to see to @Strong on <a href="https://discord.gg/AfYdzr2C">his discord</a>!</b>
            </p>
            <div id="donate-button-container">
                <div id="donate-button"></div>
                <script src="https://www.paypalobjects.com/donate/sdk/donate-sdk.js" charset="UTF-8"></script>
                <script>
                PayPal.Donation.Button({
                env:'production',
                hosted_button_id:'B4LEV6GZB6YP2',
                image: {
                src:'https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif',
                alt:'Donate with PayPal button',
                title:'PayPal - The safer, easier way to pay online!',
                }
                }).render('#donate-button');
                </script>
            </div>
        </div>
        <!-- Simulator Section -->
        <div id="simulator" class="section polling" style="display: none;">
            <div id="poll">
                <h1>Please Answer Poll Before Using</h1>
                I received a message from Reynad, the developer of Bazaar.<br/><br/>
                <i><b>"Hey, unfortunately we need you to take down bazaarplanner.com.<br/>Combat simulation is a red line for us with external tools because it will harm gameplay a lot in the long run."</b></i><br/><br/>
                I think he's right that simulators can harm gameplay, but I'm not sure what we're doing here will do that. <br/>
                As long as the simulator is external, and mostly a tool to learn, perhaps it will increase engagement, enjoyment, and entertainment within the game when you play!
                <br><br>
                Also, even if they aren't online for YOU to use, people will be using them and passing them around. It's better to make it public than give the few players an advantage who privately use them.<br/>
                Check out <a href="https://www.twitch.tv/gaara/clip/ThoughtfulArtsyFiddleheadsPunchTrees-iOVtPoMxI5rSIU48">this reaction</a> from a pro hearthstone gamer when he found out the bazaartracker dev was banned from the subreddit for letting people know Reynad served a DMCA takedown.
                <br/><br/>
                <hr>
                <br/><br/>
                <h1>What do you think?</h1>
                <font size="+1">Will this site harm gameplay or your enjoyment of the game?</font><br/>
                <i>(you must login to vote - if you login with twitch, the only information given is your twitch user id, which is already public information on twitch)</i>
                <div class="poll-login">
                    <button class="editorOpener" onclick="showLogin()">Login</button>
                </div>             
                <div class="poll-button-group">
                    <button onclick="poll(true)">Yes</button>
                    <button onclick="poll(false)">No</button>          
                </div>
            </div>
            <div id="monster-search-container">
                <div class="search-container" style="width: 100%">
                    <input type="text" 
                           autocomplete="off" 
                           class="search-input" 
                           id="monster-search"
                           onkeyup="searchMonsters(this.value)"
                           onfocus="searchMonsters('')"
                           onchange="if(monsters[this.value]){
                             loadMonsterBoard(monsters[this.value]); 
                             this.defaultValue = this.value;
                           }"
                           placeholder="Search monsters...">
                    <div id="monster-dropdown" class="search-dropdown"></div>
                    <!--coming soon
                    <div id="import" class="import"><input type="text" id="import-input" placeholder="Import from bazaar insights" onChange="importFromBazaarInsights(this.value)"/></div>
                    -->
                </div>                         
            </div>
            <div style="display: flex; gap: 20px;">
                <div id="simulator-items">           
                    <input type="text" style="width: calc(100% - 5px); height: 24px;margin-bottom:5px;" id="simulator-search-input" class="search-input" list="simulator-suggestions" onkeyup="search(this.value)" autocomplete="off" placeholder="Search items...">         
                    <div id="simulator-itemsList"></div>
                </div>
                <div style="position: relative;">
                    <div class="battle-controls">
                        <div class="battle-buttons">
                            <button onclick="mainBattle.startBattle()" class="battle-button">Start Battle</button>
                            <button onclick="mainBattle.resetBattle()" class="battle-button">Reset Battle</button>
                        </div>
                        <div id="copy-url-container">
                            <button onclick="getTinyUrl()" class="battle-button">Get Tiny URL</button>
                        </div>
                    </div>
                    <div class="board-container">
                       <div id="t" class="board">
                            <!-- Slots will be generated here -->
                        </div>
                        <div class="board-controls">
                            <button onclick="Board.getBoardFromId('t').clear()">Clear</button>
                            <button onclick="Board.getBoardFromId('t').save()">Save</button>
                            <button onclick="Board.getBoardFromId('t').load()">Load</button>
                        <!--    <button onclick="Board.getBoardFromId('t').importFromBazaarTracker()">Import</button>                            
                        -->
                        </div>
                    </div>
                    <div class="board-container">
                        <div id="b" class="board">
                            <!-- Slots will be generated here -->
                        </div>
                        <div class="board-controls">
                            <button onclick="Board.getBoardFromId('b').clear()">Clear</button>
                            <button onclick="Board.getBoardFromId('b').save()">Save</button>
                            <button onclick="Board.getBoardFromId('b').load()">Load</button>
                        <!--    <button onclick="Board.getBoardFromId('b').importFromBazaarTracker()">Import</button>
                        -->
                        </div>
                    </div>
                </div>
                
            </div>
            <div id="combat-log-div"><textarea id="combat-log" class="combat-log"></textarea></div>
        </div>

        <!-- Library Section 
        <div id="library" class="section">
            <h2>Library</h2>
            <input type="text" id="library-search-input" gitclass="search-input" list="search-suggestions" onkeyup="search(this.value)" placeholder="Search...">
            <datalist id="search-suggestions"></datalist>
            <div>
                <h3>Monsters</h3>
                <div id="monstersList"></div>
            </div>
            <div>
                <h3>Items</h3>
                <div id="itemsList"></div>
            </div>
            <div>
                <h3>Skills</h3>
                <div id="skillsList"></div>
            </div>
        </div>
        -->
        <div id="auth-container">
            <div id="firebaseui-auth-container"></div>
            <div id="twitch-auth-container"><button id="twitch-login-button" class="firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised firebaseui-idp-password firebaseui-id-idp-button firebaseui-idp-text firebaseui-idp-text-long">Sign in with Twitch</button></div>
        </div>
    </body>
</html> 
